<view class="page">
  <!-- Top Nav -->
  <view class="nav" style="padding-top: {{navTop}}px; height: {{navTotal}}px;">
    <view class="nav-inner">
      <view class="nav-left" bindtap="onBack">
        <view class="nav-back">返回</view>
      </view>
      <view class="nav-title">{{hotel.nameZh || hotel.nameEn || '酒店详情'}}</view>
      <view class="nav-right"></view>
    </view>
  </view>

  <view class="content" style="padding-top: {{navSafe}}px;">
    <!-- Banner -->
    <view class="banner">
      <swiper class="banner-swiper" autoplay="false" circular="true" indicator-dots="true" indicator-color="rgba(255,255,255,0.5)" indicator-active-color="#ffffff">
        <block wx:if="{{bannerMedias.length > 0}}">
          <swiper-item wx:for="{{bannerMedias}}" wx:key="url">
            <block wx:if="{{item.type === 'video'}}">
              <video class="banner-video" src="{{item.url}}" objectFit="cover" controls="true" muted="{{true}}" show-mute-btn="true" show-fullscreen-btn="true" show-center-play-btn="true" autoplay="false" loop="false" enable-play-gesture="true" vslide-gesture="true" vslide-gesture-in-fullscreen="true" bindtap="onPreviewMedia" data-index="{{index}}" />
            </block>
            <block wx:else>
              <image class="banner-img" mode="aspectFill" src="{{item.url}}" bindtap="onPreviewMedia" data-index="{{index}}" />
            </block>
          </swiper-item>
        </block>
        <block wx:else>
          <swiper-item>
            <view class="banner-placeholder">
              <view class="banner-ph-title">YISU HOTEL</view>
              <view class="banner-ph-sub">Premium Stay Experience</view>
            </view>
          </swiper-item>
        </block>
      </swiper>
    </view>

    <!-- Base Info -->
    <view class="card">
      <view class="title-row">
        <view class="hotel-name">{{hotel.nameZh || hotel.nameEn || '-'}}</view>
        <view class="star">{{hotel.star || '-' }} 星</view>
      </view>
      <view class="sub-row">{{hotel.nameEn || ''}}</view>

      <view class="kv">
        <view class="kv-label">地址</view>
        <view class="kv-value">{{hotel.address || '-'}}</view>
      </view>

      <view class="kv">
        <view class="kv-label">设施</view>
        <view class="kv-value">
          <view class="tags" wx:if="{{facilities.length > 0}}">
            <view class="tag" wx:for="{{facilities}}" wx:key="*this">{{item}}</view>
          </view>
          <view class="muted" wx:else>暂无设施信息</view>
        </view>
      </view>
    </view>

    <!-- Calendar + Guests + Nights Banner -->
    <view class="card banner2">
      <view class="banner2-title">入住信息</view>
      <view class="banner2-row">
        <view class="date-block">
          <view class="date-label">入住</view>
          <picker mode="date" value="{{checkIn}}" start="{{today}}" bindchange="onCheckInChange">
            <view class="date-value">{{checkIn}}</view>
          </picker>
        </view>

        <view class="mid">
          <view class="nights">{{nights}} 晚</view>
          <view class="line"></view>
        </view>

        <view class="date-block">
          <view class="date-label">离店</view>
          <picker mode="date" value="{{checkOut}}" start="{{today}}" bindchange="onCheckOutChange">
            <view class="date-value">{{checkOut}}</view>
          </picker>
        </view>
      </view>

      <view class="banner2-row2">
        <view class="counter">
          <view class="counter-label">人数</view>
          <view class="counter-ctl">
            <view class="btn" bindtap="decGuests">-</view>
            <view class="num">{{guests}}</view>
            <view class="btn" bindtap="incGuests">+</view>
          </view>
        </view>
        <view class="counter">
          <view class="counter-label">房间</view>
          <view class="counter-ctl">
            <view class="btn" bindtap="decRooms">-</view>
            <view class="num">{{roomCount}}</view>
            <view class="btn" bindtap="incRooms">+</view>
          </view>
        </view>
      </view>
    </view>

    <!-- Rooms -->
    <view class="card">
      <view class="section-title">房型价格</view>
      <view class="section-sub">价格从低到高（按商户录入）</view>

      <view class="room" wx:for="{{rooms}}" wx:key="id" bindtap="onSelectRoom" data-index="{{index}}">
        <view class="room-left">
          <view class="room-name">{{item.name}}</view>
          <view class="room-sub">可订 · 含税/服务费规则以实际为准</view>
        </view>
        <view class="room-right">
          <view class="price">
            <text class="yen">¥</text>
            <text class="p">{{item.price}}</text>
          </view>
          <view class="per">每晚</view>
        </view>
      </view>

      <view wx:if="{{rooms.length === 0}}" class="empty">暂无房型</view>
    </view>

    <view wx:if="{{error}}" class="error">{{error}}</view>
    <view class="footer-space"></view>
  </view>
</view>
